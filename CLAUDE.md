# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## What This Repo Is

Gaia is a **state-only** repository — no application code, no builds, no tests. It is the central index of a holistic life management ecosystem where GitHub is the source of truth, Obsidian is the read/write interface, and Claude (Code + .ai) is the intelligence layer.

All state lives in version-controlled YAML-frontmatter Markdown files. There is no custom backend.

## Architecture (5 Layers)

1. **State Store** — This repo (`Gaia`) + distributed project repos registered in `manifest.yaml`
2. **Domain Modules** — `domains/*.md` files covering health, finances, languages, social, creative, calendar, goals, work-projects, ai-projects, business-ideas
3. **Integration** — Claude Code hooks, skills, MCPs (GitHub, Google Calendar, Filesystem)
4. **Interface** — Desktop (Claude Code), Mobile (Obsidian + Git sync), Any device (Claude.ai)
5. **Temporal** — Morning planning, active work support, evening reflection via `/plan` and `/reflect` commands

## File Conventions

### Domain state files (`domains/*.md`)

Every domain file uses this schema:

```yaml
---
domain: <name>
updated: <ISO 8601 timestamp>
updated_by: <claude-code-hook | manual>
status: active
review_cycle: weekly
next_review: <date>
tags: [...]
---
```

Body sections (in order): **Current State**, **Active Goals**, **Habits & Routines**, **Recent Activity**, **Next Actions**, **Notes**, **Links**.

- "Recent Activity" is **append-only** — hooks append entries, never overwrite
- "Current State", "Goals", "Notes" are human-edited sections (typically via Obsidian)
- Cross-domain references use standard markdown links (e.g., `[calendar](calendar.md)`)

### Temporal files (`temporal/`)

- `today.md` — regenerated each morning by `/plan`, updated throughout the day by hooks
- `weekly-review.md`, `monthly-review.md` — rolling summaries generated by `/review`
- `templates/` — Templater-compatible templates for morning plan, evening reflection, weekly review

### Journal (`journal/YYYY/MM/YYYY-MM-DD.md`)

Daily logs, append-only. Created during morning planning, extended during evening reflection.

### Manifest (`manifest.yaml`)

Registry of all connected project repos. Each entry has: name, github path, domain, status, description. Used by post-session hooks to map a project back to its domain file.

### Dashboards (`dashboards/`)

Obsidian Dataview-powered aggregated views. Query YAML frontmatter across domain files.

## Write Protocols

### Hook writes (automated)

1. Always `git pull --rebase` before writing
2. Only modify: frontmatter timestamps, "Recent Activity" (append), "Next Actions"
3. On merge conflict: stage as `.pending` file, do not force-resolve

### Manual writes (Obsidian / Claude Code)

- Edit "Current State", "Active Goals", "Habits & Routines", "Notes", "Links" freely
- Avoid editing "Recent Activity" manually — it's hook-managed

## Key Skills and Commands

- `/plan` — Morning planning: reads all domains + calendar, generates `temporal/today.md`
- `/reflect` — Evening reflection: summarises day, flags incomplete items, drafts tomorrow's priorities
- `/status [domain]` — Show current state of one or all domains
- `/update [domain]` — Interactive domain state update
- `/review [weekly|monthly]` — Periodic review generation
- `/inbox` — Route unstructured notes/ideas to appropriate domain files
- `/link [project]` — Register a new repo in `manifest.yaml`

## Important Constraints

- This repo must remain **private** (contains sensitive personal data across health, finances, relationships)
- Obsidian Git syncs every 5-10 minutes on mobile — avoid rapid successive commits that could cause conflicts
- Domain files are designed for Obsidian's properties panel — keep frontmatter keys consistent across all domain files
- The `.obsidian/workspace.json` and other local Obsidian config should be in `.gitignore`
